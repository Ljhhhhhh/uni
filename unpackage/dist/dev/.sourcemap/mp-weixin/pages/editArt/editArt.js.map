{"version":3,"sources":["webpack:///D:/www/uni/pages/editArt/editArt.vue","webpack:///D:/www/uni/pages/editArt/editArt.vue?e28d","webpack:///D:/www/uni/main.js","webpack:///D:/www/uni/pages/editArt/editArt.vue?5350","webpack:///D:/www/uni/pages/editArt/editArt.vue?96c0","webpack:///D:/www/uni/pages/editArt/editArt.vue?dcee"],"names":["artId","loginRes","_self","signModel","require","data","title","artList","inputContent","needUploadImg","uploadIndex","caties","currentCateIndex","catiesFromApi","sedCateIndex","onLoad","options","sign","apiServer","checkLogin","uni","request","url","method","success","res","art","artContent","art_content","JSON","parse","art_title","status","categories","k","push","art_cate","cateName","i","length","console","log","methods","submitNow","showToast","icon","type","content","indexOf","tmpurl","indexID","uploadImg","showLoading","getStorageSync","header","stringify","uid","random","cate","setTimeout","switchTab","uploader","uploadFile","filePath","name","uploadFileRes","index","staticServer","fail","cateChange","e","sedIndex","detail","value","cate_name","cate_id","removeImg","currentTarget","dataset","showModal","confirm","splice","deleteText","submit","artText","addImg","chooseImage","count","sizeType","tempFilePaths","Page","App"],"mappings":"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ACA,qBAAqB;AACrB,yBAAyB;AACzB,mBAAmB;AACnB;AACA;AACA;AACA,4BAA4B,sBAAsB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,+BAA+B,oCAAoC;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,2BAA2B;AAC3B,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS,SAAS,wBAAwB,OAAO,qBAAqB,EAAE;AACxE;AACA,sBAAsB,2BAA2B;AACjD;AACA;AACA;AACA;AACA,wBAAwB,wBAAwB;AAChD,qBAAqB;AACrB,eAAe;AACf;AACA;AACA;AACA;AACA,eAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB,6BAA6B,0BAA0B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,mBAAmB,SAAS,yCAAyC,EAAE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,0BAA0B;AAC5C;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,qBAAqB;AACrB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,wBAAwB;AAC9C,mBAAmB;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC3LA;AACA;AACI,2I;AACAC,IAAI,CAAC,+BAAYC,gBAAZ,CAAD,CAAJ,C;;;;;;;;;;;;ACHJ;AAAA;AAAA;AAAA;AAAA;AAAsF;AAC3B;AACL;;;AAGtD;AAC2I;AAC3I,gBAAgB,wJAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,kFAAM;AACR,EAAE,2FAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,gF;;;;;;;;;;;;ACtCf;AAAA;AAAA;AAAA;AAA2qB,CAAgB,isBAAG,EAAC,C;;;;;;;;;;;;ACA/rB;AAAA;AAAA;AAAA;AAAA;AAAA","file":"pages/editArt/editArt.js","sourcesContent":["\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar artId, loginRes, _self;\r\nvar signModel = require('../../commons/sign.js');\r\nexport default {\r\n  data() {\r\n    return {\r\n      title: '',\r\n      artList: [],\r\n      inputContent: '',\r\n      needUploadImg: [],\r\n      uploadIndex: 0,\r\n      //分类\r\n      caties: ['点击选择'],\r\n      currentCateIndex: 0,\r\n      catiesFromApi: [],\r\n      // 记录真实选择的api接口数据的分类id\r\n      sedCateIndex: 0\r\n    };\r\n  },\r\n  onLoad: function(options) {\r\n    artId = options.artId;\r\n    _self = this;\r\n    signModel.sign(this.apiServer);\r\n    loginRes = this.checkLogin('../my/my', '2');\r\n    if (!loginRes) {\r\n      return false;\r\n    }\r\n    // 加载文章默认值\r\n    uni.request({\r\n      url: this.apiServer + 'art&m=info&artid=' + artId,\r\n      method: 'GET',\r\n      data: {},\r\n      success: res => {\r\n        var art = res.data.data;\r\n        // 文章内容转换并展示\r\n        var artContent = art.art_content;\r\n        artContent = JSON.parse(artContent);\r\n        _self.artList = artContent;\r\n\r\n        // 默认值赋值\r\n        this.title = art.art_title;\r\n        // 加载文章分类并设置默认值\r\n        uni.request({\r\n          url: _self.apiServer + 'category&m=index',\r\n          method: 'GET',\r\n          success: res => {\r\n            if (res.data.status == 'ok') {\r\n              // 把数据格式整理为 picker 支持的格式 ['分类名', ...]\r\n              var categories = res.data.data;\r\n              for (var k in categories) {\r\n                _self.caties.push(categories[k]);\r\n              }\r\n              // 记录分类信息\r\n              _self.catiesFromApi = categories;\r\n              // 获取当前分类的默认值\r\n              _self.sedCateIndex = art.art_cate;\r\n              // 对应的查找picker的默认值\r\n              var cateName = categories[art.art_cate];\r\n              for (var i = 0; i < _self.caties.length; i++) {\r\n                if (cateName == _self.caties[i]) {\r\n                  _self.currentCateIndex = i;\r\n                  break;\r\n                }\r\n              }\r\n              console.log(_self.currentCateIndex);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    });\r\n  },\r\n  methods: {\r\n    submitNow: function() {\r\n      // 数据验证\r\n      if (this.title.length < 2) {\r\n        uni.showToast({ title: '请输入标题', icon: 'none' });\r\n        return;\r\n      }\r\n      if (this.artList.length < 1) {\r\n        uni.showToast({ title: '请填写文章内容', icon: 'none' });\r\n        return;\r\n      }\r\n      if (this.sedCateIndex < 1) {\r\n        uni.showToast({ title: '请选择分类', icon: 'none' });\r\n        return;\r\n      }\r\n      // 上传图片 一次一个多次上传 [ 递归函数 ]\r\n      // 上传完成后整体提交数据\r\n      // 首先整理一下需要上传的图片\r\n      // this.needUploadImg = [{tmpurl : 临时地址, index : 数据索引}]\r\n      this.needUploadImg = [];\r\n      for (var i = 0; i < this.artList.length; i++) {\r\n        if (this.artList[i].type == 'image') {\r\n          if (this.artList[i].content.indexOf('192.168.31.') == -1) {\r\n            this.needUploadImg.push({ tmpurl: this.artList[i].content, indexID: i });\r\n          }\r\n        }\r\n      }\r\n      this.uploadImg();\r\n    },\r\n    uploadImg: function() {\r\n      // 如果没有图片 或者已经上传完成 则执行提交\r\n      if (this.needUploadImg.length < 1 || this.uploadIndex >= this.needUploadImg.length) {\r\n        uni.showLoading({ title: '正在提交' });\r\n        // 将信息整合后提交到服务器\r\n        var sign = uni.getStorageSync('sign');\r\n        uni.request({\r\n          url: this.apiServer + 'art&m=edit&artid=' + artId,\r\n          method: 'POST',\r\n          header: { 'content-type': 'application/x-www-form-urlencoded' },\r\n          data: {\r\n            title: _self.title,\r\n            content: JSON.stringify(_self.artList),\r\n            uid: loginRes[0],\r\n            random: loginRes[1],\r\n            cate: _self.sedCateIndex,\r\n            sign: sign\r\n          },\r\n          success: res => {\r\n            if (res.data.status == 'ok') {\r\n              uni.showToast({ title: '提交成功', icon: 'none' });\r\n              setTimeout(function() {\r\n                uni.switchTab({\r\n                  url: '../my/my'\r\n                });\r\n              }, 1000);\r\n            } else {\r\n              uni.showToast({ title: res.data.data, icon: 'none' });\r\n            }\r\n          }\r\n        });\r\n        return;\r\n      }\r\n      // 上传图片\r\n      uni.showLoading({ title: '上传图片' });\r\n      var uploader = uni.uploadFile({\r\n        url: _self.apiServer + 'uploadImg&m=index',\r\n        filePath: _self.needUploadImg[_self.uploadIndex].tmpurl,\r\n        name: 'file',\r\n        success: uploadFileRes => {\r\n          uploadFileRes = JSON.parse(uploadFileRes.data);\r\n          if (uploadFileRes.status != 'ok') {\r\n            console.log(uploadFileRes);\r\n            uni.showToast({ title: '上传图片失败,请重试!', icon: 'none' });\r\n            return false;\r\n          }\r\n          // 将已经上传的文件地址赋值给文章数据\r\n          var index = _self.needUploadImg[_self.uploadIndex].indexID;\r\n          _self.artList[index].content = _self.staticServer + uploadFileRes.data;\r\n          console.log(_self.artList);\r\n          _self.uploadIndex++;\r\n          // 递归上传\r\n          setTimeout(function() {\r\n            _self.uploadImg();\r\n          }, 1000);\r\n        },\r\n        fail: () => {\r\n          uni.showToast({ title: '上传图片失败,请重试!', icon: 'none' });\r\n        }\r\n      });\r\n    },\r\n    cateChange: function(e) {\r\n      var sedIndex = e.detail.value;\r\n      this.currentCateIndex = sedIndex;\r\n      // 获取选择的分类名称\r\n      if (sedIndex < 1) {\r\n        return;\r\n      }\r\n      var cateName = this.caties[sedIndex];\r\n      for (var i = 0; i < this.catiesFromApi.length; i++) {\r\n        if (cateName == this.catiesFromApi[i].cate_name) {\r\n          this.sedCateIndex = this.catiesFromApi[i].cate_id;\r\n          break;\r\n        }\r\n      }\r\n      this.currentCateIndex = sedIndex;\r\n      console.log(this.sedCateIndex);\r\n    },\r\n    removeImg: function(e) {\r\n      console.log(e);\r\n      var index = e.currentTarget.dataset.index;\r\n      uni.showModal({\r\n        content: '确定要删除此图片吗',\r\n        title: '提示',\r\n        success(e) {\r\n          if (e.confirm) {\r\n            _self.artList.splice(index, 1);\r\n          }\r\n        }\r\n      });\r\n    },\r\n    deleteText: function(e) {\r\n      var index = e.currentTarget.dataset.index;\r\n      uni.showModal({\r\n        content: '确定要删除吗',\r\n        title: '提示',\r\n        success(e) {\r\n          if (e.confirm) {\r\n            _self.artList.splice(index, 1);\r\n          }\r\n        }\r\n      });\r\n    },\r\n    submit: function(res) {\r\n      var content = res.detail.value.artText;\r\n      if (content.length < 1) {\r\n        uni.showToast({ title: '请输入内容', icon: 'none' });\r\n        return;\r\n      }\r\n      this.artList.push({ type: 'text', content: content });\r\n      this.inputContent = '';\r\n    },\r\n    addImg: function() {\r\n      uni.chooseImage({\r\n        count: 1,\r\n        sizeType: ['compressed'],\r\n        success: function(res) {\r\n          _self.artList.push({ type: 'image', content: res.tempFilePaths[0] });\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"view\",\n    { staticClass: \"wrap\" },\n    [\n      _c(\"view\", { staticClass: \"write_title\" }, [\n        _c(\"input\", {\n          directives: [\n            {\n              name: \"model\",\n              rawName: \"v-model\",\n              value: _vm.title,\n              expression: \"title\"\n            }\n          ],\n          attrs: {\n            type: \"text\",\n            placeholder: \"请输入标题\",\n            eventid: \"2f05f31c-0\"\n          },\n          domProps: { value: _vm.title },\n          on: {\n            input: function($event) {\n              if ($event.target.composing) {\n                return\n              }\n              _vm.title = $event.target.value\n            }\n          }\n        })\n      ]),\n      _c(\n        \"view\",\n        { staticClass: \"artList\" },\n        _vm._l(_vm.artList, function(item, index) {\n          return _c(\"block\", { key: index }, [\n            item.type == \"image\"\n              ? _c(\"view\", { staticClass: \"item\" }, [\n                  _c(\"image\", {\n                    attrs: {\n                      src: item.content,\n                      \"data-index\": index,\n                      mode: \"widthFix\",\n                      eventid: \"2f05f31c-1-\" + index\n                    },\n                    on: { tap: _vm.removeImg }\n                  })\n                ])\n              : _vm._e(),\n            item.type == \"text\"\n              ? _c(\"view\", { staticClass: \"item\" }, [\n                  _c(\"textarea\", {\n                    directives: [\n                      {\n                        name: \"model\",\n                        rawName: \"v-model\",\n                        value: _vm.artList[index].content,\n                        expression: \"artList[index].content\"\n                      }\n                    ],\n                    attrs: {\n                      value: item.content,\n                      placeholder: \"\",\n                      eventid: \"2f05f31c-2-\" + index\n                    },\n                    domProps: { value: _vm.artList[index].content },\n                    on: {\n                      input: function($event) {\n                        if ($event.target.composing) {\n                          return\n                        }\n                        _vm.artList[index].content = $event.target.value\n                      }\n                    }\n                  }),\n                  _c(\n                    \"view\",\n                    {\n                      staticClass: \"deleteText\",\n                      attrs: {\n                        \"data-index\": index,\n                        eventid: \"2f05f31c-3-\" + index\n                      },\n                      on: { tap: _vm.deleteText }\n                    },\n                    [_vm._v(\"删除\")]\n                  )\n                ])\n              : _vm._e()\n          ])\n        })\n      ),\n      _c(\n        \"form\",\n        { attrs: { eventid: \"2f05f31c-6\" }, on: { submit: _vm.submit } },\n        [\n          _c(\"view\", { staticClass: \"inputArea\" }, [\n            _c(\n              \"view\",\n              {\n                staticClass: \"addImg\",\n                attrs: { eventid: \"2f05f31c-4\" },\n                on: { tap: _vm.addImg }\n              },\n              [_vm._v(\"+图片\")]\n            ),\n            _c(\n              \"view\",\n              { staticClass: \"addText\" },\n              [\n                _c(\"textarea\", {\n                  directives: [\n                    {\n                      name: \"model\",\n                      rawName: \"v-model\",\n                      value: _vm.inputContent,\n                      expression: \"inputContent\"\n                    }\n                  ],\n                  attrs: {\n                    name: \"artText\",\n                    maxlength: \"-1\",\n                    placeholder: \"请输入文本\",\n                    eventid: \"2f05f31c-5\"\n                  },\n                  domProps: { value: _vm.inputContent },\n                  on: {\n                    input: function($event) {\n                      if ($event.target.composing) {\n                        return\n                      }\n                      _vm.inputContent = $event.target.value\n                    }\n                  }\n                }),\n                _c(\n                  \"button\",\n                  { attrs: { type: \"primary\", \"form-type\": \"submit\" } },\n                  [_vm._v(\"添加\")]\n                )\n              ],\n              1\n            )\n          ])\n        ]\n      ),\n      _c(\"view\", { staticClass: \"art-cate\" }, [\n        _c(\"view\", [_vm._v(\"文章分类\")]),\n        _c(\n          \"view\",\n          {},\n          [\n            _c(\n              \"picker\",\n              {\n                attrs: {\n                  mode: \"selector\",\n                  range: _vm.caties,\n                  eventid: \"2f05f31c-7\"\n                },\n                on: { change: _vm.cateChange }\n              },\n              [_c(\"view\", [_vm._v(_vm._s(_vm.caties[_vm.currentCateIndex]))])]\n            )\n          ],\n          1\n        )\n      ]),\n      _vm.artList.length > 0\n        ? _c(\n            \"view\",\n            {\n              staticClass: \"submitNow\",\n              attrs: { eventid: \"2f05f31c-8\" },\n              on: { tap: _vm.submitNow }\n            },\n            [_vm._v(\"编辑文章\")]\n          )\n        : _vm._e()\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import 'uni-pages';\nimport pageFactory from 'mpvue-page-factory'\n    import App from './pages/editArt/editArt.vue'\n    Page(pageFactory(App))","import { render, staticRenderFns } from \"./editArt.vue?vue&type=template&id=725edcf6&\"\nimport script from \"./editArt.vue?vue&type=script&lang=js&\"\nexport * from \"./editArt.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('725edcf6', component.options)\n    } else {\n      api.reload('725edcf6', component.options)\n    }\n    module.hot.accept(\"./editArt.vue?vue&type=template&id=725edcf6&\", function () {\n      api.rerender('725edcf6', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"D:/www/uni/pages/editArt/editArt.vue\"\nexport default component.exports","import mod from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--18-0!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./editArt.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--18-0!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./editArt.vue?vue&type=script&lang=js&\"","export * from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./editArt.vue?vue&type=template&id=725edcf6&\""],"sourceRoot":""}